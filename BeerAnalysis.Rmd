---
title: "Beer Analysis"
author: "Abahay Sharma and Derek Rogers"
date: "2022-10-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(dplyr)
library(ggthemes)
library(plotly)
```

```{r}
BeerDataFrame = data.frame(read.csv("C:/SMU MS Data Science/DoingDataScience6306/MSDS_6306_Doing-Data-Science/Unit 8 and 9 Case Study 1/Beers.csv"))
BreweriesDataFrame = data.frame(read.csv("C:/SMU MS Data Science/DoingDataScience6306/MSDS_6306_Doing-Data-Science/Unit 8 and 9 Case Study 1/Breweries.csv"))

BeerDataFrame
BreweriesDataFrame
```
```{r}
# Manually add in missing data for beers of intrest
BeerDataFrame[BeerDataFrame$Name == "Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale",]$IBU = 35
```

```{r}
# Tidy data
```


```{r}
# Merge beer data with breweries data
names(BreweriesDataFrame)[1] = "Brewery_id"
mergedBeerData = merge(BeerDataFrame, BreweriesDataFrame, by = "Brewery_id")

head(mergedBeerData, 6)
tail(mergedBeerData, 6)
```

```{r}
# Find the beer with the largest ABV and IBU and return those row

"Highest ABV:"
max(mergedBeerData$ABV, na.rm = TRUE)
"Highest IBU:"
max(mergedBeerData$IBU, na.rm = TRUE)

mergedBeerData[which.max(mergedBeerData$ABV),]
mergedBeerData[which.max(mergedBeerData$IBU),]
```

```{r}
# create histogram of the number of players at a given position


NumberOfBreweriesInEachStateHistogram = ggplot(data = BreweriesDataFrame, aes(x=State)) + 
  geom_bar(stat = "count") + 
  labs(subtitle="Number of Breweries in each State", 
       y="Count", 
       x="State", 
       title="Number of breweries in each state") +
  theme_wsj() +
  theme(axis.text.x = element_text(size = rel(0.8), angle = 90))

ggplotly(NumberOfBreweriesInEachStateHistogram)
```

```{r}
# Show a map of the US to show how many breweries are in each state with usmap and ggplot2
library(usmap)
library(ggplot2)


plot_usmap(regions = "states") + labs(title = "U.S States")
```

```{r}
# Show a map of the US to show how many breweries are in each state with plotly
library(plotly)

g = list(scope = 'usa')

fig = plot_geo(BreweriesDataFrame, locationmode = 'USA-states') %>%
  add_trace(
    colors = 'purples'
  ) %>%
  colorbar(title = "Number of breweries in each state") %>%
  layout(geo = g)
```

```{r}

```

```{r}

```

```{r}

```